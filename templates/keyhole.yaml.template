# keyhole.yaml â€“ Agent-Keyhole configuration
# Documentation: https://github.com/agent-keyhole/agent-keyhole

services:
  github:
    domains:
      - api.github.com
    auth:
      type: bearer
      secret_ref: github-token
    placeholder: "KEYHOLE_MANAGED"
    sdk_env:
      GITHUB_TOKEN: "{{placeholder}}"
    headers:
      Accept: application/vnd.github+json
      X-GitHub-Api-Version: "2022-11-28"
    response_masking:
      patterns:
        - "ghp_[A-Za-z0-9_]{36}"
        - "gho_[A-Za-z0-9_]{36}"
        - "ghs_[A-Za-z0-9_]{36}"
      json_paths:
        - "$.token"
        - "$.credentials.access_token"

  openai:
    domains:
      - api.openai.com
    auth:
      type: bearer
      secret_ref: openai-api-key
    placeholder: "sk-keyhole-000000000000000000000000000000000000000000000000"
    sdk_env:
      OPENAI_API_KEY: "{{placeholder}}"
    response_masking:
      patterns:
        - "sk-[A-Za-z0-9]{20,}"

  # anthropic:
  #   domains:
  #     - api.anthropic.com
  #   auth:
  #     type: custom_header
  #     header_name: x-api-key
  #     secret_ref: anthropic-api-key
  #   placeholder: "sk-ant-keyhole-000000000000000000000000000000000000"
  #   sdk_env:
  #     ANTHROPIC_API_KEY: "{{placeholder}}"

# Optional: Multi-agent access control
# agents:
#   content-bot:
#     services: [github, openai]
#   deploy-bot:
#     services: [github]

# Optional: Logging
# logging:
#   output: stderr
#   level: info

# Optional: VPS alerting
# alerting:
#   webhook_url: https://discord.com/api/webhooks/xxx/yyy
#   message_prefix: "my-project"
